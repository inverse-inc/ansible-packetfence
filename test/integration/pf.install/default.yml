---
- name: pf.install test suite
  hosts: test-kitchen
  vars_files:
    - roles/pf.install/tests/api_calls.yml
  roles:
    - role: pf.install
      # we always test latest builds
      vars:
        centos:
          repo: packetfence-devel
        deb:
          repos:
            - debian
            - debian-devel
        pf_config_general:
            hostname: "{{ ansible_distribution|lower }}"
            domain: example.lan
            dhcpservers: 10.0.0.1,192.168.122.1
            timezone: Europe/Paris
        pf_config_alerting:
            smtpserver: glauca.inverse
            fromaddr: "{{ pf_config_general['hostname'] }}@{{ pf_config_general['domain'] }}"
            emailaddr: alerting@inverse.ca
            smtp_port: 1025
            smtp_verifyssl: disabled
            subjectprefix: PF UNDER TEST
            smtp_timeout: 30
        pf_users:
          - body:
              pid: user1
              email: user1@foo.com
              password: user1
          - body:
              pid: user2
              email: user2@foo.com
              password: user2
