---
pf_api_calls:
  # finish configurator through API
  - route: "{{ pf_api_config_endpoints['base'] }}/general"
    method: PATCH
    body:
      id: general
      dhcpservers: "{{ pf_config_general['dhcpservers'] }}"
      domain: "{{ pf_config_general['domain'] }}"
      hostname: "{{ pf_config_general['hostname'] }}"
      timezone: "{{ pf_config_general['timezone'] }}"
  - route: "{{ pf_api_config_endpoints['base'] }}/alerting"
    method: PATCH
    body:
      id: alerting
      smtpserver: "{{ pf_config_alerting['smtpserver'] }}"
      fromaddr: "{{ pf_config_alerting['fromaddr'] }}"
      emailaddr: "{{ pf_config_alerting['emailaddr'] }}"
      smtp_port: "{{ pf_config_alerting['smtp_port'] }}"
      smtp_verifyssl: "{{ pf_config_alerting['smtp_verifyssl'] }}"
      subjectprefix: "{{ pf_config_alerting['subjectprefix'] }}"
      smtp_timeout: "{{ pf_config_alerting['smtp_timeout'] }}"
  - route: "{{ pf_api_config_endpoints['fingerbank_setting'] }}/upstream"
    method: PATCH
    body:
      id: upstream
      api_key: 123456
  - route: "{{ pf_api_config_endpoints['base'] }}/advanced"
    method: PATCH
    body:
      id: advanced
      hash_passwords: ntlm
  # create new admin user
  - route: "{{ pf_api_users }}"
    method: POST
    body: 
      pid: admin2
      email: "admin2@{{ pf_config_general['domain'] }}"
      address: "7000 Park Avenue, Montreal"
      anniversary: "1988-01-01"
      apartment_number: 104
      birthday: "1988-01-02"
      building_number: 10
      cell_phone: 514-942-7456
      company: Inverve inc.
      custom_field_1: custom_field
      custom_field_2: custom_field
      custom_field_3: custom_field
      custom_field_4: custom_field
      custom_field_5: custom_field
      custom_field_6: custom_field
      custom_field_7: custom_field
      custom_field_8: custom_field
      custom_field_9: custom_field
      firstname: admin
      gender: string
      lang: FR
      lastname: 2
      nickname: adm
      notes: This user rocks
      potd: null
      psk: rysdetJegyaufEc
      room_number: 104
      sponsor: admin
      telephone: "+33789898989"
      title: IT
      work_phone: "+33789898989"
      login_remaining: null
      can_sponsor: 1
  - route: "{{ pf_api_user }}/admin2/password"
    method: POST
    body:
      # access_duration:
      access_level: ALL
      # category:
      ## Date need quotes
      expiration: "2038-01-01 00:00:00"
      # login_remaining: 0
      password: admin2
      pid: admin2
      sponsor: true
      #unregdate: 0000-00-00 00:00:00
      valid_from: "{{ ansible_date_time['date'] }} {{ ansible_date_time['time'] }}"
